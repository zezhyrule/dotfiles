(function(){if(isSafari()&&window.top!=window)return;var e={};e.base="http://news.ycombinator.org/",e.buttons=[{text:"save to pocket",successText:"saved to pocket",container:"td.subtext",className:"pocket-hn-button",selector:".pocket-hn-button",data:function(e){var t=$(e).parents("tr").prev("tr").find(".title").children("a"),n=$(t).text().trim(),r=$(t).attr("href").trim();return{title:n,url:r}}}];var t=function(e){var t=document.createElement("a");return t.setAttribute("class",e.className),t.setAttribute("href","#"),$(t).text(e.text),t},n=function(){var n,r=e.buttons.length;for(n=0;n<r;n++){var i=e.buttons[n];$(i.container).each(function(){var e=$(this);if($(e).hasClass("pocket-inserted"))return;$(e).addClass("pocket-inserted");var n=t(i);$(e).append(n),$(n).before(" | ");var r=i.data;$(n).click(function(t){var s=r(n),o={id:"hackernews",action:"addURL",url:s.url,title:s.title};sendMessage(o,function(e){e.status==="success"&&($(n).replaceWith($("<span>"+i.successText+"</span>")),document.body.style.cursor="default"),window.thePKT_BM.handleMessageResponse(e)}),t.preventDefault()})})}};addMessageListener(function(e,t,r){e.action==="settingChanged"&&e.key==="hackernews"&&(e.value==="true"||e.value===!0)&&n()}),sendMessage({action:"getSetting",key:"hackernews"},function(e){(e.value==="true"||e.value===!0)&&n()})})();